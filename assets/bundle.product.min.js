window.REBASE=window.REBASE||{},REBASE.theme=REBASE.theme||{},function(){function changeTimezone(date,ianatz){var invdate=new Date(date.toLocaleString("en-US",{timeZone:ianatz})),diff=date.getTime()-invdate.getTime();return new Date(date.getTime()+diff)}function msToTime(s){var ms,secs,mins=(s=((s=(s-s%1e3)/1e3)-s%60)/60)%60,hrs=(s-mins)/60,hours,minutes,output="";return hrs>=24?"24 hours":(hrs>0&&(output=hrs+" hr"),hrs>0&&mins>0&&(output+=", "),mins>0&&(output+=mins+" min"),output)}function ordinalSuffixOf(i){var j=i%10,k=i%100;return 1==j&&11!=k?"st":2==j&&12!=k?"nd":3==j&&13!=k?"rd":"th"}function addZipCode(zipCode){return' Ship to: <strong id="zipcode">'+zipCode+'</strong> <a href="#" id="change-zipcode">Change Zip</a><input name="zipcode-input" id="zipcode-input" class="visually-hidden" value="'+zipCode+'"/><a href="#" id="save-zipcode" class="visually-hidden">Update</a>'}function returningUser(){var returningUserDate=localStorage.getItem("returningUser"),today=new Date;return returningUserDate?today>=(returningUserDate=new Date(returningUserDate)):(today.setHours(today.getHours()+24),localStorage.setItem("returningUser",today.toISOString()),!1)}function showOrderWithinMessage(){if(!returningUser()){var then=new Date;then.setHours(24,0,0,0);var orderBy=msToTime((then=changeTimezone(then,"America/Los_Angeles"))-new Date),today=new Date,businessDays=2;today.setDate(today.getDate()+2),today.toDateString().includes("Sat")&&today.setDate(today.getDate()+2),today.toDateString().includes("Sun")&&today.setDate(today.getDate()+1);var newDateTimeFormat=new Intl.DateTimeFormat("en",{timeZone:"America/Los_Angeles",weekday:"long",month:"short",day:"numeric"});deliveryDay=newDateTimeFormat.format(today);var deliveryDayNum=deliveryDay.split(" ")[2],receiveBy=deliveryDay+ordinalSuffixOf(deliveryDayNum),geoInfo=localStorage.getItem("Fomo.geocodeResponse");if(geoInfo){geoInfo=JSON.parse(geoInfo);var zipCode=localStorage.getItem("zipCodeInUS")||geoInfo.zip_code;if("US"==geoInfo.country_code){var output='<div id="product-order-by" style="text-align: center"><p>Get it by <strong id="receive-by">'+receiveBy+"</strong> Order within "+orderBy+"."+addZipCode(zipCode)+"</p></div>";$("#add-to-cart").before(output),$("body").on("click","#change-zipcode",(function(e){e.preventDefault(),console.log("zipCode clicked"),$("#zipcode").addClass("visually-hidden"),$("#change-zipcode").addClass("visually-hidden"),$("#zipcode-input").removeClass("visually-hidden"),$("#save-zipcode").removeClass("visually-hidden")})),$("body").on("click","#save-zipcode",(function(e){e.preventDefault(),console.log("zipCode clicked"),$("#change-zipcode").removeClass("visually-hidden"),$("#zipcode-input").addClass("visually-hidden"),$("#save-zipcode").addClass("visually-hidden"),localStorage.setItem("zipCodeInUS",$("#zipcode-input").val()),$("#zipcode").html($("#zipcode-input").val()).removeClass("visually-hidden")}))}}}}function onDOMLoaded(){var currentSelectedFlavors,defaultBundleInput=$(".product-option--bundle.product-option--selected input");if(REBASE.theme.product_photo_gallery=new Swiper(".gallery.swiper-container",{effect:"slide",loop:!0,speed:300,slidesPerView:1.25,centeredSlides:!0,spaceBetween:20,navigation:{nextEl:".swiper__button--next",prevEl:".swiper__button--prev"},thumbs:{swiper:REBASE.theme.product_photo_thumbs},breakpoints:{960:{slidesPerView:1,centeredSlides:!1,spaceBetween:0}}}),$(document).on("click",".thumbs .thumbs__item",(function(){REBASE.theme.product_photo_gallery.slideToLoop($(this).data("index"))})),product=new REBASE.theme.Product({$container:$("#add-to-cart-form")}),product.currentVariant?(currentSelectedFlavors=product.currentVariant.option1.split("+"),$(".product-option").removeClass("product-option--selected"),$('.product-option--bundle input[value="'+product.currentVariant.option3+'"]').click(),currentSelectedFlavors.forEach((function(flavor){$('.product-option--flavor input[value="'+flavor.trim()+'"]').click()}))):defaultBundleInput.click(),$(".sold-in-number")&&$("#add-to-cart-form")){var productId=$("#add-to-cart-form").data("productid"),soldInNum=localStorage.getItem(productId+"SoldIn");soldInNum||(soldInNum=Math.floor(71*Math.random()+150),localStorage.setItem(productId+"SoldIn",soldInNum)),$(".sold-in-number").html(soldInNum)}showOrderWithinMessage()}document.addEventListener("DOMContentLoaded",onDOMLoaded)}(),REBASE.theme.Product=function(){function Product(options){this.variants=null,this.$container=options.$container,this.data=JSON.parse(document.getElementById("product__json").innerHTML),this.currentVariant=JSON.parse(document.getElementById("current_variant__json").innerHTML),this.variantDefaults=JSON.parse(document.getElementById("variant__defaults").innerHTML),this.variantPerBagPrices=JSON.parse(document.getElementById("variant_per_bag").innerHTML),this.settings={single_option_selector:".single-option-select",original_select_id:"select#product-select"},this.data?this._initVariants():console&&console.log("Missing product json data!")}return Product.prototype=$.extend({},Product.prototype,{_initVariants:function(){var options={$container:this.$container,enable_history_state:!0,single_option_selector:this.settings.single_option_selector,original_select_id:this.settings.original_select_id,product:this.data};this.variants=new REBASE.theme.Variants(options),this.$container.on("variantChange",this._updateAddToCart.bind(this)),this.$container.on("variantChange",this._updatePrices.bind(this)),this.$container.on("optionChange",this._updateSelectedOption.bind(this))},_setSlashPrice:function(variant){var one_time_slash_price=variant.compare_at_price||"",subscription_slash_price=variant.compare_at_price||"",formatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2});variant.price==variant.compare_at_price&&(one_time_slash_price=""),0!==one_time_slash_price.length&&(one_time_slash_price=formatter.format(.01*one_time_slash_price)),0!==subscription_slash_price.length&&(subscription_slash_price=formatter.format(.01*subscription_slash_price)),$("#slash_price_one_time").text(one_time_slash_price),$("#slash_price_subscription").text(subscription_slash_price)},_setPerBagPrices:function(id){var prices=this.variantPerBagPrices[id];$(".per-bag--once").html(prices.once),$(".per-bag--subs").html(prices.subs)},_getSelectedBundleLimit:function(){return $(".product-option--bundle.product-option--selected input").data("flavor-limit")},_getSelectedFlavorCount:function(){return $(".product-option--flavor.product-option--selected").length},_setFlavorsForBundle:function(type){$(".product-option--flavor").removeClass("product-option--selected"),defaultFlavors=this.variantDefaults[type].split("|"),defaultFlavors.forEach((function(df){$('.product-option--flavor input[value="'+df+'"]').click()}))},_getDisabledButtonLabel:function(count){switch(count){case 1:return"Select 2nd Flavor";case 2:return"Select 3rd Flavor";case 3:return"Select 4th Flavor"}},_updateBundleOption:function(value){$(".product-option--bundle").removeClass("product-option--selected"),$('.product-option--bundle input[value="'+value+'"]').parents(".product-option").addClass("product-option--selected")},_updateFlavorOption:function(value){var limit=this._getSelectedBundleLimit(),count=this._getSelectedFlavorCount();count<limit&&$('.product-option--flavor input[value="'+value+'"]').parents(".product-option").addClass("product-option--selected"),count>=limit&&($(".product-option--flavor").removeClass("product-option--selected"),$('.product-option--flavor input[value="'+value+'"]').parents(".product-option").addClass("product-option--selected"))},_updateSelectedOption:function(e){var type=e.target.dataset.type,value=e.target.value;"bundle"==type?(this._updateBundleOption(value),this._setFlavorsForBundle(value)):"flavor"==type&&this._updateFlavorOption(value)},_updatePrices:function(e){e.variant&&(this._setSlashPrice(e.variant),this._setPerBagPrices(e.variant.id))},_updateAddToCart:function(e){var btn=$("#add-to-cart"),btnText=$("#add-to-cart-text"),limit=this._getSelectedBundleLimit(),selectedCount=this._getSelectedFlavorCount(),buttonLabel=btnText.data("add-to-cart-text");!e.variant||limit>selectedCount?(buttonLabel=this._getDisabledButtonLabel(selectedCount),btn.addClass("disabled"),$(".product-option--flavor.product-option--selected").length<=0&&(buttonLabel="Sold Out")):btn.removeClass("disabled"),btnText.text(buttonLabel)}}),Product}(),REBASE.theme.Variants=function(){function Variants(options){this.$container=options.$container,this.product=options.product,this.single_option_selector=options.single_option_selector,this.original_select_id=options.original_select_id,this.enable_history_state=options.enable_history_state,this.variantFlavorLimits=JSON.parse(document.getElementById("variant__flavor_limits").innerHTML),this.current_variant={},$(this.single_option_selector,this.$container).on("click",this._onOptionChange.bind(this))}return Variants.prototype=$.extend({},Variants.prototype,{_getCurrentSelections:function(){var options=[];return(options=$.map($(this.single_option_selector,this.$container),(function(el){var $el,current_option={};return!!$(el).parents(".product-option--selected").length&&(current_option.value=el.value,current_option.type=el.dataset.type,current_option)}))).filter(Boolean)},_getVariantFromOptions:function(){var selected_values=this._getCurrentOptions(),variants=this.product.variants,found;return{variant_match:found=(found=$.grep(variants,(function(variant){return selected_values.every((function(values){return variant[values.index]===values.value}))}))).length?found[0]:void 0}},_getSelectedBundle:function(){return $('input[name="single-option-select-bundle"]:checked').val()},_getFlavorLimit:function(value){return this.variantFlavorLimits[value]},_getSelectedVariant:function(){var currentSelections=this._getCurrentSelections(),variants=[],variant=null,validSelection=!1,bundleOption=currentSelections.filter((function(cs){return"bundle"===cs.type}))[0],flavorOptions=currentSelections.filter((function(cs){return"flavor"===cs.type}));switch(bundleOption.value){case"variety":var varietyOptionsLength=Math.min($(".product-options--flavors .product-option").length,this._getFlavorLimit(bundleOption.value));validSelection=flavorOptions.length===varietyOptionsLength;break;case"bundle":case"single":case"single-sm":validSelection=flavorOptions.length===this._getFlavorLimit(bundleOption.value)}return validSelection&&(variants=(variants=this.product.variants.filter((function(variant){return variant.option3===bundleOption.value}))).filter((function(variant){var valid=!0;return flavorOptions.forEach((function(flavorOption){variant.option1.includes(flavorOption.value)||(valid=!1)})),valid}))).length>0&&(variant=variants[0]),variant},_onOptionChange:function(e){var variant=null,selected_bundle=this._getSelectedBundle();this.$container.trigger({type:"optionChange",target:e.target,selected_bundle:selected_bundle}),variant=this._getSelectedVariant(),this._variantChange(variant),variant?(this._updateMasterSelect(variant),this._updatePrice(variant),this.current_variant=variant,this.enable_history_state&&this._updateHistoryState(variant)):this.current_variant={}},_variantChange:function(variant){this.$container.trigger({type:"variantChange",variant:variant})},_updatePrice:function(variant){variant.price===this.current_variant.price&&variant.compare_at_price===this.current_variant.compare_at_price||this.$container.trigger({type:"variantPriceChange",variant:variant})},_updateHistoryState:function(variant){if(history.replaceState&&variant){var urlParams=new URLSearchParams(window.location.search);urlParams.set("variant",variant.id);var newurl=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+urlParams.toString();window.history.replaceState({path:newurl},"",newurl)}},_updateMasterSelect:function(variant){$(this.original_select_id,this.$container).val(variant.id)}}),Variants}();